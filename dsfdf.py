def snake_and_ladder_game(arr):
    n = len(arr)

    def is_valid(die_value):
        dp = [-1] * n
        dp[-1] = 0

        for i in range(n - 2, -1, -1):
            if arr[i] == 0:
                continue

            max_moves = float('-inf')

            for j in range(1, min(n - i, die_value + 1)):
                if dp[i + j] != -1:
                    max_moves = max(max_moves, dp[i + j] + 1)

            if max_moves != float('-inf'):
                dp[i] = max_moves

        # If there's no valid path to reach the last square, return False
        return dp[0] != -1

    left, right = 1, n - 1
    result = 0

    while left <= right:
        mid = (left + right) // 2
        if is_valid(mid):
            result = mid
            left = mid + 1
        else:
            right = mid - 1

    if result == 0:
        return n
    else:
        return result * result


provided_example = [
    9, 66, 22, 216, 121, 107, 102, 46, 219, 50, 62, 240, 204, 130, 103, 140, -13, 161, 101, 105, -16, 100, -10, 181,
    189, 18, 97, -17, 132, -11, 217, -6, 227, 76, 69, 7, 15, 120, 150, 169, 39, 135, -15, 210, -9, 65, 119, -6, 129,
    161, 65, 122, 23, 177, 161, 27, 96, 185, 23, -25, 68, -41, 44, 76, -43, -8, 84, 16, 127, 122, 88, 60, 140, 60, -9,
    -58, 170, -39, -26, -11, -61, 87, 3, 138, 114, 104, -24, 141, -15, 41, 50, 120, -26, 112, 126, -7, -26, -66, 46,
    -94, -72, 3, 69, -54, 128, 147, 63, -68, 3, 91, 91, 21, 138, -66, 39, 103, 45, -104, -82, -86, -70, -66, -62, 94,
    -50, -56, -62, 43, -91, -39, -10, 103, -86, 103, 124, 109, 23, 14, -16, 118, -117, 83, -49, -52, 46, 48, -57, -141,
    91, -1, 12, -64, -68, -138, -122, 17, 53, -79, -72, -83, -11, -16, 63, 72, -119, -29, 36, -51, -70, 72, -90, -115,
    -72, -36, 5, 10, 57, -50, 36, -78, -164, 45, 40, 1, 45, -18, -89, -88, -59, -82, -72, -169, 45, 55, -20, -101, -94,
    46, 58, -24, -95, -153, -176, -11, -5, 49, -42, -61, -70, -27, -170, -4, -18, -32, -122, -29, -20, -209, -141, -32,
    -57, -167, 16, -109, -161, -211, -155, -101, -226, -228, -95, -118, -203, -53, -223, -94, -89, -14, -143, -178,
    -196, -211, -45, 12, -88, 4, -150, -64, -82, -115, -47, -20, -7, -246, -14, -255, -198, -115, -104, -261
]

result = snake_and_ladder_game(provided_example)
print(result)  
